; .flockflockrc 
; system-wide configuration file for file access policy
;
; format:
;     policy_class policy_type path_component process_name temporary_pid
;
; syntax: 
;     policy_class
;         allow    allow any read operations matching this policy
;         allow!   allow any read operations not matching this policy
;         deny     deny any read operations matching this policy
;         deny!    deny any read operations not matching this policy
;
;     policy_type
;         prefix    policy applies to file/dirs matching prefix 
;             useful for things like SQLite databases with multiple files
;             can also use for directory prefixing
;         path      policy applies to file at direct path_component
;             use a slash at the end to indicate a directory prefix
;             using 'path', nested directories don't apply to the rule.
;             to apply nested directories also, use "prefix"
;         suffux    policy applies to file suffix path_component
;             can be used for extensions or folders in home directories
; 
;     path_component
;         the path component intended to match policy_type
;         must be encapsulates in quotes to accommodate spaces
;
;     process_name
;         policy applies to all processes matching process_name
;         must be encapsulated in quotes to accommodate spaces
;         use "any" to apply to all processes
;         use a slash at the end to indicate a path

; allow access to any files outside of /Users
allow! prefix "/Users/" "any"

; allow preferences files to be read
allow suffix ".plist" "any"
allow suffix ".bundle" "any"

; trust all system components (same mechanism protects this area with sip)
allow path "any" "/System/Library/"
allow path "any" "/usr/libexec/"
allow path "any" "/usr/sbin/"

; let unix processes read certain files
allow path "$HOME/.profile" "/bin/bash"
allow path "$HOME/.CFUserTextEncoding" "any"

; many processes map libs into memory that store things in the keychain
allow suffix ".keychain-db" "any"
allow suffix "/login.keychain" "any"

; vim
allow path "$HOME/.vimrc" "/usr/bin/vim"
allow path "$HOME/.viminfo" "/usr/bin/vim"

; lots of things read bash history
allow path "$HOME/.bash_history" "any"
allow prefix "$HOME/.bash_sessions/" "any"

; common user apps
allow path "$HOME/Library/Caches/com.apple.preferencepanes.cache" "/Applications/System Preferences.app/"

; common user paths
allow prefix "$HOME/Library/Logs" "any"
allow prefix "$HOME/Library/Preferences" "any"

; vim
allow suffix ".swpx" "/usr/bin/vim"
allow suffix ".swp" "/usr/bin/vim"

; .DS_Store files (ugh)
allow suffix "/.DS_Store" "any"
allow suffix "/.localized" "any"

